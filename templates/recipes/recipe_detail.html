{% extends 'base.html' %}

{% block title %}{{ recipe.name }} - Recipe Book{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'recipe-list' %}">Recipes</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ recipe.name }}</li>
    </ol>
</nav>

<div class="row">
    <div class="col-md-8">
        <h1 class="mb-3">{{ recipe.name }}</h1>
        
        <div class="d-flex mb-3">
            <div class="me-4">
                <i class="far fa-clock"></i> Prep Time: {{ recipe.preparation_time }} mins
            </div>
            <div class="me-4">
                <i class="fas fa-fire"></i> Cook Time: {{ recipe.cooking_time }} mins
            </div>
            <div class="me-4">
                <i class="fas fa-clock"></i> Total Time: {{ recipe.total_time }} mins
            </div>
        </div>
        
        <div class="d-flex mb-3">
            <div class="me-4">
                <i class="fas fa-utensils"></i> Category: {{ recipe.get_category_display }}
            </div>
            <div class="me-4">
                <i class="fas fa-chart-line"></i> Difficulty: {{ recipe.get_difficulty_display }}
            </div>
            <div>
                <i class="fas fa-users"></i> Servings: {{ recipe.servings }}
            </div>
        </div>
        
        <div class="mb-3">
            <span class="text-muted">
                <i class="fas fa-user me-1"></i> Posted by: {{ recipe.user.username }}
            </span>
        </div>
        
        {% if recipe.description %}
        <div class="mb-4">
            <h5>Description</h5>
            <p>{{ recipe.description }}</p>
        </div>
        {% endif %}
        
        <div class="mb-4">
            <h5>Ingredients</h5>
            <ul class="list-group">
                {% for ingredient in recipe.ingredients.all %}
                    <li class="list-group-item">
                        {{ ingredient.quantity }} {{ ingredient.unit }} {{ ingredient.name }}
                    </li>
                {% empty %}
                    <li class="list-group-item">No ingredients listed</li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="mb-4">
            <h5>Preparation Steps</h5>
            <div class="card">
                <div class="card-body">
                    {{ recipe.preparation_steps|linebreaks }}
                </div>
            </div>
        </div>
        
        {% if user.is_authenticated and user.id == recipe.user.id %}
        <div class="mb-4">
            <div class="d-flex">
                <a href="{% url 'recipe-update' recipe.pk %}" class="btn btn-primary me-2">
                    <i class="fas fa-edit"></i> Edit Recipe
                </a>
                <a href="{% url 'recipe-delete' recipe.pk %}" class="btn btn-danger">
                    <i class="fas fa-trash"></i> Delete Recipe
                </a>
            </div>
        </div>
        {% endif %}
    </div>
    
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Recipe Image</h5>
            </div>
            <div class="card-body p-0">
                {% with primary=recipe.images.filter.first %}
                    {% if primary %}
                        <img src="{{ primary.image.url }}" class="img-fluid recipe-detail-img w-100" alt="{{ recipe.name }}">
                    {% else %}
                        <img src="https://via.placeholder.com/300x400?text=No+Image" class="img-fluid recipe-detail-img w-100" alt="No Image">
                    {% endif %}
                {% endwith %}
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Additional Images</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% for image in recipe.images.all %}
                        {% if not forloop.first %}
                            <div class="col-6 mb-2">
                                <img src="{{ image.image.url }}" class="img-thumbnail" alt="{{ recipe.name }}">
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}